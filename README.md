## 写在前面  
这只是一个用来展示超大图片的 Demo，由于静态资源过大，被放到了 CDN 上  
在 clone 项目后可以执行项目根目录下的 `configure.sh`下载 Demo运行所需图片  
如果脚本报 `command not found: wget`错误，可以 `brew install wget`解决  

所有测试基于真机 iPhone SE，2GB RAM，A9.

### 已知缺陷  
* 只适配了 JPEG 格式
* <del>默认 1:1缩放，所以第一屏看到的是一个局部图，并没有像目前图片展示的交互逻辑写。</del>
* <del>因为默认 1:1缩放，所以在缩小查看全图的时候有渲染延迟，会像 “瓦片”那样一片一片渲染出来，低性能机器可能会更慢一点。如果在第一屏展示全缩略图，用 loading 延迟展示第一屏，后面再放大查看会好一点（因为 GPU有纹理缓存/我也写了一点缓存)</del>
* 贴图的渲染级别始终比较高（采样率比较高），因为机器没有足够的性能可以创建缓冲区载入更大的切片采样，应该可以搞一些其他方案进行更低采样率的采样

### 觉得可以改善的地方 
* 目前 JPEG的切片解码到位图始终依赖 CPU，虽然不会阻塞，但仍然没有硬解快。可以继续研究一下硬解的方案 （是不是真的像业界传说的没什么办法）
* <del>现在内存缓存设置得比较大，整个运行时峰值可能会达到 200MB，低内存机器可能就会吃紧了。除去内存缓存，实际运行时内存比较小（不到 30MB）</del>
* <del>写了一个简单的 LRU 管理文件缓存，内存缓存踢出来的贴图会以 LRU 的形式管理写进文件系统。但 LRU貌似并不太适合这种场景，对渲染速度提升帮助很小</del>
* 采样的问题，没解决过类似问题，所以也没在网上搜到什么方案，后面可以看一下它的二进制存储结构来设计采样方案

## change log 
* 默认展示全图缩略图
* 因为全图比较大，渲染需要一点时间，所以加了个首次 loading，视觉上友好一点
* 去掉了内存缓存，减轻内存压力
* 去掉了文件缓存，提高了性能🤣 （GPU纹理缓存比想象的要快）
* 去掉了不必要的内存分配，目前峰值目测不超过 50MB